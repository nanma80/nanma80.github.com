<!DOCTYPE html>
<html>
<head>
  <title>Lights Out</title>
  <script src="lib/point3d.js"></script>
  <script src="lib/sticker.js"></script>
  <script src="lib/puzzle.js"></script>
  <script src="lib/mouse.js"></script>
  <script src="lib/puzzleBuilderHelper.js"></script>
  <script src="lib/puzzleBuilder.js"></script>

  <link href="style/main.css" rel="stylesheet" type="text/css">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.05, maximum-scale=1.05, user-scalable=no">

</head>
<body onselectstart='return false;'>

<div class="title">
  Polyhedral Lights Out<br>
</div>

<div id="content">
  <canvas id="canvas" width="550" height="550" oncontextmenu="return false;" onselectstart='return false;'>
    Your browser does not support the HTML5 canvas tag.
  </canvas>
</div>

<div class="control">
  <button type="button" onclick = "puzzle.resetState();">Reset</button> 
  <button type="button" onclick = "puzzle.scramble();">Scramble</button>
</div>

<div class="control">Shape: 
  <select id="shape" onchange="onShapeChange();">
    <option value="cube">Cube</option>
    <option value="octahedron">Octahedron</option>
    <option value="dodecahedron" selected>Dodecahedron</option>
    <option value="icosahedron">Icosahedron</option>
    <option value="vertex first cube">Cuboctahedron</option>
    <option value="face first dodecahedron">Icosidodecahedron</option>
    <option value="soccer">Soccer Ball</option>
  </select>
</div>

<div class="control">Neighbors defined as:
  <select id="neighborhood">
    <option value="2" selected>sharing an edge</option>
    <option value="1">sharing a vertex</option>
  </select>
</div>

<div class="comment">
  <p>Click a tile to toggle its neighbors. Click "scramble" and turn off all tiles to win. </p>
  <p>The puzzle uses html5 canvas, which is not supported directly by IE 8 or lower. I also apologize if the animation is jumpy on some browsers. Try using the latest version of Chrome for the best experience.</p>
  <p>Nan Ma, 2014</p>
  <p id="log"></p>
</div>

<script type="text/javascript">
  var canvas = document.getElementById("canvas");
  var context = canvas.getContext("2d");
  var size = 550;
  if (window.innerWidth < 520) {
    size = 320;
  }
  canvas.width = size;
  canvas.height = size;


  var viewHeight = canvas.height;
  var viewWidth = canvas.width;


  var invertMirrorX = false; // For mirror X mode and the mirror X moves in the full puzzle. When false: clicked corner will move, when true, clicked corner will not move

  var puzzle = new Puzzle();

  onShapeChange();
  canvas.addEventListener("mousedown", mouseDown, false);
  canvas.addEventListener("mousemove", mouseMove, false);
  canvas.addEventListener("mouseover", mouseOver, false);
  canvas.addEventListener("mouseout", mouseOut, false);

  canvas.addEventListener("touchstart", mouseDown, false);
  canvas.addEventListener("touchmove", touchMove, true);
  canvas.addEventListener("touchend", touchUp, false);

  document.body.addEventListener("mouseup", mouseUp, false);
  document.body.addEventListener("touchcancel", touchUp, false);
</script>


</body>
</html>
